{{#
	@name Section
	@desc A column repeater block to be included in the page builder
    @set page.page_builder.section
#}}

<!-- /page_builder/_section.antlers.html -->

{{ section_style =  '' }}
{{ section_class =  'fluid-container auto-rows-max xl:auto-rows-auto overflow-x-hidden
                grid-cols-6 md:grid-cols-12' }}

{{ xid =  id }}
{{ if slug  }}
    {{ slug =  slug | slugify | replace('-', '') }}
    {{ xid =  slug }}
{{ /if }}
{{ if section_slug  }}
    {{ slug =  section_slug | slugify | replace('-', '') }}
    {{ xid =  slug }}
{{ /if }}

{{ hide_viewports }}
    {{ if ( value == 'mobile' ) }}
        {{ section_class .=  ' hidden' }}
    {{ else }}
        {{ section_class .=  ' grid' }}
    {{ /if }}

    {{ if ( value == 'tablet' ) }}
        {{ section_class .=  ' md:hidden' }}
    {{ else }}
        {{ section_class .=  ' md:grid' }}
    {{ /if }}

    {{ if ( value == 'desktop' ) }}
        {{ section_class .=  ' xl:hidden' }}
    {{ else }}
        {{ section_class .=  ' xl:grid' }}
    {{ /if }}
{{ /hide_viewports }}

{{ if ! hide_viewports }}
    {{ section_class .=  ' grid' }}
{{ /if }}

{{# Mentioning the exact class names in comments, its styles will be compiled. #}}
{{# gap-0 gap-0.5 gap-1 gap-1.5 gap-2 gap-2.5 gap-3 gap-3.5 gap-4 gap-5 gap-6 gap-7 gap-8 gap-9 gap-10 gap-11 gap-12 #}}
{{ if section_gap }}
    {{ section_class .=  ' md:gap-'+section_gap }}
{{ else }}
    {{ section_class .=  ' gap-[16px] md:gap-[32px]' }}
{{ /if }}


{{ if screen_minimum_height }}
    {{ section_class .=  ' min-h-screen' }}
{{ /if }}

{{ if remove_columns_gap}}
    {{ section_class .=  ' md:!gap-0' }}
{{ /if }}

{{ vertical_padding = false }}

{{# pt-0 pt-1 pt-2 pt-3 pt-4 pt-5 pt-6 pt-7 pt-8 pt-9 pt-10 pt-11 pt-12 pt-13 pt-14 pt-15 pt-16 pt-32 #}}
{{# md:pt-0 md:pt-1 md:pt-2 md:pt-3 md:pt-4 md:pt-5 md:pt-6 md:pt-7 md:pt-8 md:pt-9 md:pt-10 md:pt-11 md:pt-12 md:pt-13 md:pt-14 md:pt-15 md:pt-16 md:pt-32 #}}
{{ if top_padding != -1 }}
    {{ section_class .=  ' pt-' + (top_padding*4) }}
    {{ vertical_padding = true }}
{{ /if }}

{{# pb-0 pb-1 pb-2 pb-3 pb-4 pb-5 pb-6 pb-7 pb-8 pb-9 pb-10 pb-11 pb-12 pb-13 pb-14 pb-15 pb-16 pb-32 #}}
{{# md:pb-0 md:pb-1 md:pb-2 md:pb-3 md:pb-4 md:pb-5 md:pb-6 md:pb-7 md:pb-8 md:pb-9 md:pb-10 md:pb-11 md:pb-12 md:pb-13 md:pb-14 md:pb-15 md:pb-16 md:pb-32 #}}
{{ if bottom_padding != -1 }}
    {{ section_class .= ' pb-' + (bottom_padding*4) }}
    {{ vertical_padding = true }}
{{ /if }}

{{# pl-0 pl-1 pl-2 pl-3 pl-4 pl-5 pl-6 pl-7 pl-8 pl-9 pl-10 pl-11 pl-12 pl-13 pl-14 pl-15 pl-16 #}}
{{# md:pl-0 md:pl-1 md:pl-2 md:pl-3 md:pl-4 md:pl-5 md:pl-6 md:pl-7 md:pl-8 md:pl-9 md:pl-10 md:pl-11 md:pl-12 md:pl-13 md:pl-14 md:pl-15 md:pl-16 #}}
{{ if left_padding != -1 }}
    {{ section_class .=  ' pl-' + (left_padding*4) }}
{{ /if }}

{{# pr-0 pr-1 pr-2 pr-3 pr-4 pr-5 pr-6 pr-7 pr-8 pr-9 pr-10 pr-11 pr-12 pr-13 pr-14 pr-15 pr-16 #}}
{{# md:pr-0 md:pr-1 md:pr-2 md:pr-3 md:pr-4 md:pr-5 md:pr-6 md:pr-7 md:pr-8 md:pr-9 md:pr-10 md:pr-11 md:pr-12 md:pr-13 md:pr-14 md:pr-15 md:pr-16 #}}
{{ if right_padding != -1 }}
    {{ section_class .= ' pr-' + (right_padding*4) }}
{{ /if }}

{{# py-1 py-2 py-3 py-4 py-5 py-6 py-7 py-8 py-9 py-10 py-11 py-12 py-13 py-14 py-15 py-16
    md:py-1 md:py-2 md:py-3 md:py-4 md:py-5 md:py-6 md:py-7 md:py-8 md:py-9 md:py-10 md:py-11 md:py-12 md:py-13 md:py-14 md:py-15 md:py-16 #}}
{{ if ! vertical_padding }}
    {{ section_class .=  ' py-4 md:py-8'}}
{{ /if }}

{{ if top_border }}
    {{ section_class .=  ' border-black border-t' }}
{{ /if }}

{{ taxonomy_colour =  '' }}
{{ if sectors }}
    {{ sectors }}
        {{ taxonomy_colour =  colour }}
    {{ /sectors }}
{{ endif }}


{{# text-black text-white  #}}

{{ text_colour_set =  null }}
{{ if text_colour }}
    {{ text_colour_set =  text_colour }}
{{ /if }}
{{ if text_colour_type == 'taxonomy' &&  taxonomy_colour }}
    {{ text_colour_set =  taxonomy_colour }}
{{ endif }}
{{ if text_colour_type == 'default' }}
    {{ text_colour_set =  null  }}
{{ endif }}

{{ if text_colour_set }}
    {{ section_class .=  ' text-' + text_colour_set }}
{{ /if }}


{{# bg-black bg-white  #}}
{{ background_colour_set =  null }}
{{ if background_colour }}
    {{ background_colour_set =  background_colour }}
{{ /if }}
{{ if background_colour_type == 'taxonomy' &&  taxonomy_colour }}
    {{ background_colour_set =  taxonomy_colour }}
{{ endif }}
{{ if background_colour_type == 'transparent' }}
    {{ background_colour_set =  null }}
{{ endif }}

{{ if background_colour_set }}
    {{ section_class .=  ' bg-' + background_colour_set }}
{{ /if }}

{{ if section_custom_classes }}
    {{ section_class  .=  ' ' + section_custom_classes }}
{{ /if }}

{{ if display_scrolldown_button || section_over_floating_logo }}
    {{ section_class  .=  ' relative' }}
{{ /if }}

{{ if section_over_floating_logo }}
    {{ section_class  .=  ' z-[4]' }}
{{ /if }}


{{ if bg_video_url || bg_image || bg_image_mobile }}
  {{ section_class  .=  ' relative' }}
{{ /if }}

{{# dump #}}

{{ if section_link }}
<a href="{{ section_link }}" class="block section-wrapper no-space-y">
{{ else}}
<div class="section-wrapper no-space-y">
{{ /if }}

    {{# If this section contains a carousel or an accordion, the animation will cause the corresponding navigation arrows to be below the floating menu items, and then they will not work. #}}
    {{# Therefore, we will not animate the appearance of the section if it contains a carousel. #}}
    {{#
        $el is a AlpineJS magic property that can be used to retrieve the current DOM node.
        querySelector() returns the first Element within the document that matches the specified selector, or group of selectors. If no matches are found, null is returned.
        Therefore  $el.querySelector('.carousel') returns null if the section does not contain a carousel.
    #}}
    {{# This is a temporary solution. #}}
<section id="{{ xid }}"
        x-data="{
            shown_{{ xid }}: false,
            load_section: {{ loading_effect ? 'true' : 'false' }},
            hasCarousel: false,
            hasAccordion: false,
            expanded: false,
            bg: ''
        }"
        x-init="hasCarousel = $el.querySelector('.carousel') !== null;
                hasAccordion = $el.querySelector('.accordion') !== null;"
        x-intersect.once="shown_{{ xid }} = true;"
        :style="`{{ section_style }} ${bg} ? `background-color: var(--color-${bg})` : ''}`"
        class="{{section_class}} transition-all duration-[300ms]"
        :class="shown_{{ xid }} && load_section && !hasCarousel && !hasAccordion ? ' reveal-section ' : '';"
>

    {{ if section_collapsable }}

        {{ html_colour =  'white' }}
        {{ if collapse_colour }}
            {{ html_colour =  collapse_colour }}
        {{ /if }}

        {{#
          stroke-black stroke-white stroke-factoryyellow stroke-skin stroke-ski stroke-khaki stroke-blush stroke-leather stroke-marrsgreen

          fill-black fill-white fill-factoryyellow fill-skin fill-ski fill-khaki fill-blush fill-leather fill-marrsgreen

          group-hover:stroke-black group-hover:stroke-white group-hover:stroke-factoryyellow group-hover:stroke-skin group-hover:stroke-ski group-hover:stroke-khaki group-hover:stroke-blush group-hover:stroke-leather group-hover:stroke-marrsgreen

          group-hover:fill-black group-hover:fill-white group-hover:fill-factoryyellow group-hover:fill-skin group-hover:fill-ski group-hover:fill-khaki group-hover:fill-blush group-hover:fill-leather group-hover:fill-marrsgreen

        #}}
        {{stroke_class = 'stroke-' + html_colour }}
        {{html_class   = class + ' cursor-pointer group text-' + html_colour }}
        {{svg_class    = 'inline -rotate-45 transition-all rounded-full -mt-[5px]'}}
        {{path_class   = 'fill-' + html_colour }}

        {{ unless collapse_remove_hover_effect }}
            {{svg_class    .= ' group-hover:bg-'+html_colour }}
            {{stroke_class .= ' group-hover:stroke-'+background_colour_set }}
        {{ /unless }}

        {{ svg_size = 'w-[20px]'}}

        {{ if collapse_text_size }}

            {{ html_class .=  " " +collapse_text_size }}

            {{ if collapse_text_size == 'h1'
                || collapse_text_size == 'h2'
            }}
                {{ svg_size = 'w-[30px] md:w-[60px]' }}
            {{ /if }}

            {{ if collapse_text_size == 'h3' }}
                {{ svg_size = 'w-[30px] md:w-[40px]' }}
                {{ html_class .=  " md:text-5xl md:leading-5xl"  }}
            {{ /if }}

            {{ if collapse_text_size == 'h4' }}
                {{ svg_size = 'w-[25px]' }}
            {{ /if }}

            {{ if collapse_text_size == 'h5' }}
                {{ svg_size = 'w-[15px]' }}
            {{ /if }}

        {{ /if }}

        {{ svg_class .= ' ' + svg_size; }}

        <div class=" max-w-none
            pt-4 md:pt-0
            md:col-span-12
            {{html_class}}"
            @click="expanded = !expanded;"
        >

            <span class="whitespace-nowrap">
                {{ section_collapsable_title }}

                <svg xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 62.01 62.01"
                    class="{{ svg_class }} "
                    x-bind:class="{'rotate-[135deg]' : !expanded  }"
                >
                    <polyline class="fill-none stroke-[2.2px] transition-all {{stroke_class}}"
                        points="20.66 21.67 40.25 21.67 40.25 41.26"
                    />
                    <line class="fill-none stroke-[2.2px] transition-all {{stroke_class}}"
                        x1="20.66"
                        y1="41.25"
                        x2="40.24"
                        y2="21.67"
                    />
                    <path class="transition-all {{path_class}}"
                        d="M31,2.2A28.8,28.8,0,1,1,2.2,31,28.83,28.83,0,0,1,31,2.2M31,0A31,31,0,1,0,62,31,31,31,0,0,0,31,0Z"
                    />
                </svg>
            </span>
        </div>

        <div
            x-show="expanded"
            x-collapse
            class="col-span-12
                grid gap-4
                md:grid-cols-12
            "
        >
        <div
            class="col-span-12
                md:h-[30px]
            "
        ></div>

    {{ /if }}

    {{ if bg_image  }}
      {{  partial:components/image
        :image="bg_image"
        figure_class="image-wrapper
          absolute top-0 left-0 z-[-3]
          w-full h-full !col-[unset]
          overflow-hidden"
        img_class="h-full w-full object-cover"
        sizes="90vw, (min-width: 1280px) 80vw"
      }}
        {{ if bg_image_mobile }}
          {{  partial:components/image
            :image="bg_image_mobile"
            figure_class="image-wrapper
              absolute top-0 left-0 z-[-2]
              w-full h-full !col-[unset]
              md:hidden
              overflow-hidden"
            img_class="h-full w-full object-cover"
            sizes="100vw"
          }}
      {{ /if }}
    {{ /if }}

    {{ if bg_video_url}}
      {{  partial:components/video
        :video_id="id"
        :video_url="bg_video_url"
        wrapper_class="video-wrapper
          absolute top-0 left-0 z-[-1]
          w-full h-full
          overflow-hidden"
        video_class="absolute
          top-1/2 left-1/2
          translate-y-[-50%] translate-x-[-50%]
          w-full h-full
          object-cover"
        video_autoplay="1"
        video_loop="1"
        video_muted="1"
        is_background_video="1"
      }}
    {{ /if }}



    {{ columns }}

        {{ column_class =  '' }}
        {{# column_class .=  ' border border-black'  #}}


        {{ column_hide_viewports }}
            {{ if ( value == 'mobile' ) }}
                {{ column_class .=  ' mobile-only:hidden' }}
            {{ /if }}

            {{ if ( value == 'tablet' ) }}
                {{ column_class .=  ' tablet-only:hidden' }}
            {{ /if }}

            {{ if ( value == 'desktop' ) }}
                {{ column_class .=  ' xl:hidden' }}
            {{ /if }}
        {{ /column_hide_viewports }}

        {{# xl:col-span-1 xl:col-span-2 xl:col-span-3 xl:col-span-4 xl:col-span-5 xl:col-span-6 xl:col-span-7 xl:col-span-8 xl:col-span-9 xl:col-span-10 xl:col-span-11 xl:col-span-12  #}}
        {{# md:col-span-1 md:col-span-2 md:col-span-3 md:col-span-4 md:col-span-5 md:col-span-6 md:col-span-7 md:col-span-8 md:col-span-9 md:col-span-10 md:col-span-11 md:col-span-12  #}}
        {{ column_span =  '' }}
        {{ if size }}
            {{ column_span =  ' md:col-span-' + size }}
            {{ if tablet_size }}
                {{ column_span =  ' md:col-span-' + tablet_size + ' xl:col-span-' + size }}
            {{ /if }}
        {{ /if }}

        {{ mobile_col_span = ' col-span-6' }}
        {{ if size_mobile }}
            {{ mobile_col_span = ' col-span-' + size_mobile }}
        {{ /if }}


        {{# xl:col-start-1 xl:col-start-2 xl:col-start-3 xl:col-start-4 xl:col-start-5 xl:col-start-6 xl:col-start-7 xl:col-start-8 xl:col-start-9 xl:col-start-10 xl:col-start-11 xl:col-start-12 xl:col-start-13  #}}
        {{# md:col-start-1 md:col-start-2 md:col-start-3 md:col-start-4 md:col-start-5 md:col-start-6 md:col-start-7 md:col-start-8 md:col-start-9 md:col-start-10 md:col-start-11 md:col-start-12 md:col-start-13  #}}
        {{ if set_horizontal_position }}
            {{ mobile_col_start =  '' }}
            {{ col_start        =  '' }}
            {{ if mobile_horizontal_position > 0 }}
                {{ mobile_col_start =  ' col-start-'+ mobile_horizontal_position }}
                {{ mobile_col_span = '' }}
            {{ /if }}

            {{ if horizontal_position > 0 }}
                {{ col_start =  ' xl:col-start-'+ horizontal_position
                }}
                {{ if tablet_horizontal_position > 0 }}
                    {{ col_start =  ' md:col-start-'+ tablet_horizontal_position +' xl:col-start-'+ horizontal_position}}
                {{ /if }}
            {{ /if }}

            {{ column_class .=  mobile_col_start + col_start }}

        {{ /if }}



        {{ if set_span_rows && span_rows > 0 }}
            {{ column_class .=  ' md:row-span-' + span_rows }}
        {{ /if }}


        {{ if vertical_alignment == 'middle' }}
            {{ column_class .=  ' flex flex-col justify-center' }}
        {{ /if }}
        {{ if vertical_alignment == 'bottom' }}
            {{ column_class .= ' flex flex-col justify-end' }}
        {{ /if }}

        {{# mbtb-only:pt-1 mbtb-only:pt-2 mbtb-only:pt-3 mbtb-only:pt-4 mbtb-only:pt-5 mbtb-only:pt-6 mbtb-only:pt-7 mbtb-only:pt-8 mbtb-only:pt-9 mbtb-only:pt-10  #}}
        {{ if mobile_top_padding != -1 }}
            {{ column_class .=  ' mbtb-only:pt-' + mobile_top_padding }}
        {{ /if }}

        {{# mbtb-only:pb-1 mbtb-only:pb-2 mbtb-only:pb-3 mbtb-only:pb-4 mbtb-only:pb-5 mbtb-only:pb-6 mbtb-only:pb-7 mbtb-only:pb-8 mbtb-only:pb-9 mbtb-only:pb-10  #}}
        {{ if mobile_bottom_padding != -1 }}
            {{ column_class .= ' mbtb-only:pb-' + mobile_bottom_padding }}
        {{ /if }}

        {{# mbtb-only:pl-1 mbtb-only:pl-2 mbtb-only:pl-3 mbtb-only:pl-4 mbtb-only:pl-5 mbtb-only:pl-6 mbtb-only:pl-7 mbtb-only:pl-8 mbtb-only:pl-9 mbtb-only:pl-10  #}}
        {{ if mobile_left_padding != -1 }}
            {{ column_class .=  ' mbtb-only:pl-' + mobile_left_padding }}
        {{ /if }}

        {{# mbtb-only:pr-1 mbtb-only:pr-2 mbtb-only:pr-3 mbtb-only:pr-4 mbtb-only:pr-5 mbtb-only:pr-6 mbtb-only:pr-7 mbtb-only:pr-8 mbtb-only:pr-9 mbtb-only:pr-10  #}}
        {{ if mobile_right_padding != -1 }}
            {{ column_class .= ' mbtb-only:pr-' + mobile_right_padding }}
        {{ /if }}


        {{ if top_padding != -1 }}
            {{ column_class .=  ' md:pt-' + (top_padding*4) }}
        {{ /if }}

        {{ if right_padding != -1 }}
            {{ column_class .=  ' md:pr-' + (right_padding*4) }}
        {{ /if }}

        {{ if bottom_padding != -1 }}
            {{ column_class .=  ' md:pb-' + (bottom_padding*4) }}
        {{ /if }}

        {{ if left_padding != -1 }}
            {{ column_class .=  ' md:pl-' + (left_padding*4) }}
        {{ /if }}

        {{ column_class .=  ' ' + mobile_col_span + column_span }}


            {{ partial:typography/article
                as="div"
                :article_slug="column_article_slug"
                :class="column_class"

            }}
                {{ column_article }}
                    {{ partial src="components/{type}" }}
                {{ /column_article }}
            {{ /partial:typography/article }}

    {{ /columns }}

    {{ if section_collapsable }}
        </div>
    {{ /if }}



</section>

{{ if section_link }}
</a>
{{ else}}
</div>
{{ /if }}

{{ if display_scrolldown_button }}
    {{ partial:components/bouncing_arrow
        :arrow_link="scroll_down_button_link"
    }}
{{ /if }}

<!-- End: /page_builder/_section.antlers.html -->
